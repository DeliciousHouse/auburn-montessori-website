---
import Layout from '../layouts/Layout.astro';
import admissions from '../data/admissions.json';
import site from '../data/site.json';
import ExternalLink from '../components/ExternalLink.astro';
import Accordion from '../components/Accordion.astro';
import PageNav from '../components/PageNav.astro';

const pageNavLinks = [
  { id: 'how-to-enroll', label: 'How to Enroll' },
  { id: 'interview-process', label: 'Interview Process' },
  { id: 'signs-of-readiness', label: 'Signs of Readiness' },
  { id: 'admission-requirements', label: 'Admission Requirements' },
  { id: 'admissions-philosophy', label: 'Admissions Philosophy' },
];
---

<Layout
  title="Admissions"
  description="Admissions and interview process for Auburn Montessori School - The Children's House."
  heroTitle="Admissions"
  heroLead="Start here for the admissions and interview process. For full policies, see the Parent Handbook."
>
  <!-- Stepper -->
  <div class="section-band">
    <div class="container-page">
      <PageNav links={pageNavLinks} />

      <h2 id="how-to-enroll" class="section-heading">How to Enroll</h2>
      <p class="section-subheading">Four steps from first visit to first day</p>

      <div class="stepper mt-6">
        {admissions.checklist.map((item) => (
          <div class="stepper-step">
            <div class="stepper-number">{item.step}</div>
            <div class="stepper-title">{item.label}</div>
            <div class="stepper-detail">{item.detail}</div>
          </div>
        ))}
      </div>

      <!-- Persistent CTA panel after steps -->
      <div class="cta-panel mt-8">
        <div class="flex flex-col items-center gap-4 text-center md:flex-row md:text-left">
          <div class="flex-1">
            <h3 class="text-lg font-bold">Ready to register?</h3>
            <p class="mt-1 text-sm" style="color: rgba(255,255,255,0.8);">Complete your registration online through Brightwheel. Registration fee: $50 (non-refundable).</p>
          </div>
          <ExternalLink href={site.registrationUrl} opensIn="Brightwheel" class="btn btn-primary btn-lg shrink-0" ariaLabel="New Parent Registration (opens in Brightwheel)">
            Register Now
          </ExternalLink>
        </div>
      </div>

      <div class="mt-5 flex flex-wrap gap-3">
        <a class="btn btn-outline btn-sm" href="/documents/parent-handbook.pdf" download>Parent Handbook (PDF)</a>
        <a class="btn btn-outline btn-sm" href="/documents/school-readiness-guidelines.pdf" download>School Readiness (PDF)</a>
        <a class="btn btn-outline btn-sm" href="/documents/fees-hours-2026-2027.pdf" download>Fees &amp; Hours (PDF)</a>
      </div>
    </div>
  </div>

  <!-- Interview process detail -->
  <div class="section-band-alt">
    <div class="container-page">
      <h2 id="interview-process" class="section-heading">Interview Process (Detail)</h2>
      <p class="section-subheading">What to expect at each stage</p>

      <div class="mt-6 space-y-5">
        {admissions.interviewSteps.map((s, i) => (
          <Accordion id={`interview-${i}`} defaultOpen={i === 0} class="card card-body" triggerClass="cursor-pointer flex items-center gap-3">
            <span slot="title">
              <span class="stepper-number" style="margin-bottom: 0;">{i + 1}</span>
              <div>
                <span class="text-sm font-bold" style="color: var(--color-neutral-900);">{s.title}</span>
                {s.timeWindow ? <span class="badge ml-2">{s.timeWindow}</span> : null}
              </div>
            </span>
            {s.bullets?.length ? (
              <ul class="mt-4 space-y-2 pl-12 text-sm leading-relaxed" style="color: var(--color-neutral-700);">
                {s.bullets.map((b) => (
                  <li class="flex gap-2">
                    <span class="shrink-0" style="color: var(--color-neutral-400);">—</span>
                    <span>{b}</span>
                  </li>
                ))}
              </ul>
            ) : null}
          </Accordion>
        ))}
      </div>
    </div>
  </div>

  <!-- Signs of success — two-column layout -->
  <div class="section-band">
    <div class="container-page">
      <h2 id="signs-of-readiness" class="section-heading">Signs of Readiness</h2>
      <p class="section-subheading">How staff evaluate interview observations (from the handbook)</p>

      <div class="mt-6 grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        <div class="card card-body">
          <div class="badge badge-success mb-3">Signs of success</div>
          <ul class="space-y-2 text-sm" style="color: var(--color-neutral-700);">
            {admissions.fitNotes.successful.map((b) => (
              <li class="flex gap-2">
                <span class="shrink-0" style="color: #059669;">✓</span>
                <span>{b}</span>
              </li>
            ))}
          </ul>
        </div>

        <div class="card card-body">
          <div class="badge badge-accent mb-3">May need more time</div>
          <ul class="space-y-2 text-sm" style="color: var(--color-neutral-700);">
            {admissions.fitNotes.mayNeedMoreTime.map((b) => (
              <li class="flex gap-2">
                <span class="shrink-0" style="color: var(--color-brand-accent);">○</span>
                <span>{b}</span>
              </li>
            ))}
          </ul>
        </div>

        <div class="card card-body">
          <div class="badge mb-3">May not be a good fit</div>
          <ul class="space-y-2 text-sm" style="color: var(--color-neutral-700);">
            {admissions.fitNotes.mayNotBeGoodFit.map((b) => (
              <li class="flex gap-2">
                <span class="shrink-0" style="color: var(--color-neutral-400);">×</span>
                <span>{b}</span>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Admission requirements -->
  <div class="section-band-alt">
    <div class="container-page">
      <div class="mx-auto max-w-3xl">
        <h2 id="admission-requirements" class="section-heading">Admission Requirements</h2>
        <p class="section-subheading">Documents and conditions for enrollment</p>
        <div class="mt-5 grid gap-3 sm:grid-cols-2">
          {admissions.admissionRequirements.map((r) => (
            <div class="flex gap-2 text-sm" style="color: var(--color-neutral-700);">
              <span class="shrink-0 mt-0.5" style="color: var(--color-brand-primary);">☐</span>
              <span>{r}</span>
            </div>
          ))}
        </div>
        <p class="mt-5 text-sm">
          See also: <a class="font-semibold" href="/parent-resources">Parent Handbook (PDF)</a>
        </p>
      </div>
    </div>
  </div>

  <!-- Overview (philosophy) -->
  <div class="section-band">
    <div class="container-page mx-auto max-w-3xl">
      <h2 id="admissions-philosophy" class="section-heading">About Our Admissions Philosophy</h2>
      <div class="mt-4 space-y-3 text-sm leading-relaxed" style="color: var(--color-neutral-700);">
        {admissions.overview.map((p) => <p>{p}</p>)}
      </div>
    </div>
  </div>
</Layout>
