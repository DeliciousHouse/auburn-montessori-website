---
import Layout from '../layouts/Layout.astro';
import site from '../data/site.json';

const addressLine = `${site.address.street} ${site.address.city}, ${site.address.state} ${site.address.postalCode}`;
const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(addressLine)}`;
const mapEmbedUrl = `https://maps.google.com/maps?q=${encodeURIComponent(addressLine)}&t=&z=15&ie=UTF8&iwloc=&output=embed`;

const tourSubject = encodeURIComponent('Request a tour - Auburn Montessori School');
const tourBody = encodeURIComponent(
  'Hello,\n\nI would like to schedule a tour of Auburn Montessori School - The Children\'s House.\n\nPreferred date/time (if any):\n\nMy name:\n\nChild\'s name and age:\n\nPhone:\n\nThank you.'
);
const tourMailto = `mailto:${site.email}?subject=${tourSubject}&body=${tourBody}`;
---

<Layout
  title="Contact"
  description="Contact Auburn Montessori School - The Children's House (address, phone, email)."
  heroTitle="Contact Us"
  heroLead="Get in touch with Auburn Montessori School - The Children's House."
>
  <div class="section-band">
    <div class="container-page grid gap-8 lg:grid-cols-5">
      <!-- Contact cards -->
      <div class="space-y-5 lg:col-span-2">
        <div class="contact-item">
          <div class="contact-icon">ğŸ“</div>
          <div>
            <div class="text-xs font-semibold uppercase tracking-wider" style="color: var(--color-neutral-500);">Address</div>
            <div class="mt-1 text-sm" style="color: var(--color-neutral-800);">
              {site.address.street}<br />
              {site.address.city}, {site.address.state} {site.address.postalCode}
            </div>
            <a class="mt-1 inline-block text-sm font-semibold" href={mapUrl} target="_blank" rel="noopener noreferrer">Open in maps â†—</a>
          </div>
        </div>

        <div class="contact-item">
          <div class="contact-icon">ğŸ“</div>
          <div>
            <div class="text-xs font-semibold uppercase tracking-wider" style="color: var(--color-neutral-500);">Phone</div>
            <a class="mt-1 block text-sm font-semibold" href={`tel:${site.phone}`}>{site.phone}</a>
          </div>
        </div>

        <div class="contact-item">
          <div class="contact-icon">âœ‰ï¸</div>
          <div>
            <div class="text-xs font-semibold uppercase tracking-wider" style="color: var(--color-neutral-500);">Email</div>
            <a class="mt-1 block text-sm font-semibold" href={`mailto:${site.email}`}>{site.email}</a>
          </div>
        </div>

        <div class="contact-item">
          <div class="contact-icon">ğŸ•</div>
          <div>
            <div class="text-xs font-semibold uppercase tracking-wider" style="color: var(--color-neutral-500);">Office Hours</div>
            <p class="mt-1 text-sm" style="color: var(--color-neutral-700);">Program hours vary. See <a class="font-semibold" href="/fees-hours">Fees &amp; Hours</a> for details.</p>
          </div>
        </div>

        <hr class="divider" />

        <a class="btn btn-outline btn-icon" href={tourMailto}>
          <span aria-hidden="true">ğŸ“§</span> Request a Tour
        </a>
        <p class="text-xs" style="color: var(--color-neutral-500);">
          Opens your email with a pre-filled message. No online forms â€” contact us directly.
        </p>
      </div>

      <!-- Map panel -->
      <div class="lg:col-span-3">
        <div class="overflow-hidden rounded-xl border shadow-sm" style="border-color: var(--color-neutral-200);">
          <iframe
            title="Auburn Montessori School location map"
            src={mapEmbedUrl}
            class="h-[20rem] w-full lg:h-[26rem]"
            loading="lazy"
            allowfullscreen=""
            referrerpolicy="no-referrer-when-downgrade"
            style="border:0;"
          ></iframe>
        </div>
      </div>
    </div>
  </div>

  <!-- Registration CTA band -->
  <div class="section-band-alt">
    <div class="container-page">
      <div class="cta-panel">
        <div class="flex flex-col items-center gap-4 text-center md:flex-row md:text-left">
          <div class="flex-1">
            <h2 class="text-lg font-bold">New Parent Registration</h2>
            <p class="mt-1 text-sm" style="color: rgba(255,255,255,0.8);">Registration is handled through Brightwheel (a third-party service) and opens in a new tab.</p>
          </div>
          <a
            class="btn btn-primary btn-lg shrink-0"
            href={site.registrationUrl}
            target="_blank"
            rel="noopener noreferrer"
            aria-label="New Parent Registration (opens in a new tab)"
          >
            Register Now â†—
          </a>
        </div>
      </div>
    </div>
  </div>
</Layout>
