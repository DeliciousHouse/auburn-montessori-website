---
import nav from '../data/navigation.json';
import site from '../data/site.json';

type Props = { currentPath: string };
const { currentPath } = Astro.props as Props;

const isActive = (href: string) => {
  if (href === '/') return currentPath === '/';
  return currentPath === href || currentPath.startsWith(`${href}/`);
};
---

<header class="border-b border-slate-200 bg-white">
  <div class="container-page flex items-center justify-between gap-4 py-4">
    <a class="no-underline" href="/" aria-label={`${site.shortName} home`}>
      <div class="leading-tight">
        <div class="text-base font-extrabold tracking-tight text-slate-900">{site.shortName}</div>
        <div class="text-sm text-slate-600">{site.tagline}</div>
      </div>
    </a>

    <nav class="hidden items-center gap-4 md:flex" aria-label="Primary">
      {nav.map((item) => (
        <a
          class:list={[
            'text-sm font-semibold no-underline',
            isActive(item.href) ? 'text-blue-800' : 'text-slate-700 hover:text-slate-900'
          ]}
          href={item.href}
          aria-current={isActive(item.href) ? 'page' : undefined}
        >
          {item.label}
        </a>
      ))}

      <a
        class="btn btn-primary"
        href={site.registrationUrl}
        target="_blank"
        rel="noopener noreferrer"
        aria-label="New Parent Registration (opens in a new tab)"
      >
        New Parent Registration (Brightwheel)
      </a>
    </nav>

    <details class="relative md:hidden">
      <summary
        class="btn btn-outline cursor-pointer select-none list-none"
        aria-label="Open menu"
      >
        Menu
      </summary>

      <div class="absolute right-0 mt-2 w-[min(90vw,22rem)] rounded-xl border border-slate-200 bg-white p-2 shadow-lg">
        <nav class="flex flex-col gap-1" aria-label="Mobile primary">
          {nav.map((item) => (
            <a
              class:list={[
                'rounded-lg px-3 py-2 text-sm font-semibold no-underline',
                isActive(item.href)
                  ? 'bg-blue-50 text-blue-900'
                  : 'text-slate-800 hover:bg-slate-50'
              ]}
              href={item.href}
              aria-current={isActive(item.href) ? 'page' : undefined}
            >
              {item.label}
            </a>
          ))}
          <div class="my-1 border-t border-slate-200"></div>
          <a
            class="btn btn-primary"
            href={site.registrationUrl}
            target="_blank"
            rel="noopener noreferrer"
            aria-label="New Parent Registration (opens in a new tab)"
          >
            New Parent Registration (Brightwheel)
          </a>
        </nav>
      </div>
    </details>
  </div>
</header>

